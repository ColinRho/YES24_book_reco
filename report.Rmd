---
title: "YES24 도서추천 알고리즘"
output: word_document
---

## 0. 서론

```{r, echo = FALSE}
source("source.R", encoding = "UTF-8")
```

알고리즘에 사용된 도구는 R입니다. R이 사용된 환경은 다음과 같습니다.

```{r}
sessionInfo()
```

소스코드나 데이터 파일은 모두 R의 working directory에 있다고 가정하고 기술됩니다. 


## 1. 데이터 호출과 조작 

데이터 셋 전체를 호출한 뒤 먼저 "구분" 변수 아래에 있는 "주문/취소/환불" 중 주문에 대한 것들만 추려냅니다. 

```{r, echo = F}
# 주문, 취소, 환분
raw %>% select(구분) %>% table()
```

따라서 전체 중 511742 건의 데이터만 활용합니다. 몇몇 변수들은 알고리즘에 활용되지 않으므로 제외합니다. 또한 구매횟수에 따라 알고리즘에 반영될 데이터를 별도로 간추립니다. 

```{r, echo = F}
# 회원별로 구매횟수변수 추가
order %>% select(NofOrder) %>% unlist(., use.names = F) %>% quantile(0.90)
```

구매기록이 1건인 경우 해당 구매기록으로 추가적인 참조가 불가능하므로 제외하고 상위 10%의 대량구매에 대해서도 참조에 유의성이 떨어질 것으로 제외하고 분석합니다.

## 2. 추천 알고리즘 (source.R)

알고리즘의 기본 원리는 "나와 같은 책을 읽은사람들이 읽은 책"을 추천하는 것입니다. 5가지 카테고리 인문/자기계발/국내문학/세계문학/종교 카테고리에 대해서 추천이 가능하게 되어있지만 다른 카테고리에 대해서도 추천알고리즘은 작동합니다. 이 알고리즘은 사용자가 주어주는 값으로서 사용자의 ID(회원번호)와 카테고리가 필요하며 추가적으로 몇개를 추천받을 것인지(기본값 = 10), 그리고 베스트셀러와의 가중치값(기본값 = 0)을 설정할 수 있습니다. 

### Step 1)

만약 회원번호가 최초로 입력된 회원번호, 즉 구매기록이 없는 회원의 경우, 해당 카테고리에서 가장 많이 팔린 도서 순으로 추천목록에 뜨게 됩니다. 

### Step 2)

비록 구매기록이 있는 회원이라도 해당 구매기록으로 특정 카테고리에 대해서는 참조할 만한 데이터가 없는 경우도 있으므로, 해당 경우에는 위와 마찬가지로 가장 많이 팔린 도서를 추천합니다. 

### Step 3)
 
그 외의 경우, 즉 구매기록이 있으면서 해당 구매기록을 통한 참조가 가능한 경우입니다. 같은 책을 구매한 다른 고객들이 어떤 책을 구매하였는지 그 빈도수에 따라 상위의 책들을 추천하게 됩니다. 

솔루션의 결과는 별도로 첨부합니다.

### 최종 알고리즘 공식

```{r, eval = F} 
simple_recommend(id, category)
```

위 R 함수에 YES24의 회원번호인 "id"와 원하는 카테고리 "category"를 입력하면 결과가 출력됩니다. 만약 추천결과의 개수를 조정하고 싶다면 "num" 값을 조정하는 것으로 가능합니다.

